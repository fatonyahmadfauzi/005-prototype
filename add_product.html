<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendaftaran Menu Sushi</title>
    <link rel="stylesheet" href="library/css/bootstrap.min.css">

    <!-- Splide CSS -->
    <link rel="stylesheet" href="library/css/splide.min.css">
    <style>
        .my-slider-progress {
            background: #ccc;
        }
        
        .my-slider-progress-bar {
            background: greenyellow;
            height: 2px;
            transition: width 400ms ease;
            width: 0;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <a class="navbar-brand" href="#">
            <img src="gambar/LOGO_FAF - White.png" alt="" style="height: 35px;">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="katalog_product">Katalog Product</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="list_product">List Product</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="add_product">Add Product</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="edit_product">Edit Product</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Bagian Header Jumbootron Dengan Splide -->
    <header class="container mt-3">
        <div class="row justify-content-center">
            <div class="col-md"> <!-- Adjust the column width as needed -->
                <div class="splide">
                    <div class="splide__track">
                        <ul class="splide__list">
                            <li class="splide__slide">
                                <div class="jumbotron text-center">
                                    <h1>Welcome to Our Website</h1>
                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                                    <a href="#" class="btn btn-primary">Learn More</a>
                                </div>
                            </li>
                            <li class="splide__slide">
                                <div class="jumbotron text-center">
                                    <h1>Welcome to Our Website</h1>
                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                                    <a href="#" class="btn btn-primary">Learn More</a>
                                </div>
                            </li>
                            <li class="splide__slide">
                                <div class="jumbotron text-center">
                                    <h1>Welcome to Our Website</h1>
                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                                    <a href="#" class="btn btn-primary">Learn More</a>
                                </div>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Add the progress bar element -->
                    <div class="my-slider-progress">
                        <div class="my-slider-progress-bar"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- End Header Jumbotron Dengan Splide -->

    <main class="container mt-1">
        <!-- Form for input data -->
        <section class="row justify-content-center">
            <div class="col-md">
                <div class="my-2 p-5 form-input bg-light rounded">
                    <div class="form-container">
                        <form id="sushiForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label class="label-with-colon" for="nama">Nama</label>
                                        <input type="text" class="form-control" id="nama" name="nama" placeholder="Nama Sushi" required>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label class="label-with-colon2" for="paketmenu">Paket Menu</label>
                                        <select id="paketmenu" name="paketmenu" class="form-control" required>
                                            <option value="Standar">Standar</option>
                                            <option value="VIP">VIP</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group mb-3">
                                        <label class="label-with-colon3">Tambahan</label>
                                        <div class="form-check">
                                            <input id="sausShoyu" class="form-check-input" type="checkbox" name="tambahan" value="Saus Shoyu">
                                            <label class="form-check-label" for="sausShoyu">Saus Shoyu</label>
                                        </div>
                                        <div class="form-check">
                                            <input id="wasabi" class="form-check-input" type="checkbox" name="tambahan" value="Wasabi">
                                            <label class="form-check-label" for="wasabi">Wasabi</label>
                                        </div>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label class="label-with-colon4" for="harga">Harga</label>
                                        <input type="number" class="form-control" id="harga" name="harga" placeholder="Harga" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <button type="button" class="btn btn-primary" onclick="saveProfile()">Submit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Alert Success -->
                <div id="successAlert" class="alert alert-success mt-3" role="alert" style="display: none;">
                    Data berhasil disimpan!
                </div>
            </div>
        </section>
    </main>

    <!-- Fetch API Footer -->
    <div id="footer"></div>

    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center">
                <p>FATONY AHMAD FAUZI Â© <span id="year"></span></p>
            </div>
        </div>
    </div>

    <script src="library/js/jquery-3.6.0.min.js"></script>
    <script src="library/js/bootstrap.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
        // Mengambil nama halaman dari URL
        var currentLocation = window.location.pathname.split("/").pop();

        // Menghapus kelas "active" dari semua elemen navbar
        var navItems = document.querySelectorAll(".navbar-nav .nav-item");
        navItems.forEach(function(item) {
            item.classList.remove("active");
        });

        // Menambahkan kelas "active" ke elemen navbar yang sesuai dengan halaman saat ini
        navItems.forEach(function(item) {
            var link = item.querySelector(".nav-link");
            if (link.getAttribute("href") === currentLocation) {
            item.classList.add("active");
            }
        });
        });
    </script>

    <!-- Splide JS -->
    <script src="library/js/splide.min.js"></script>
    <script>
        var splide = new Splide('.splide', {
            type: 'loop', // Enables infinite loop
            autoplay: true, // Enables auto-scrolling
            interval: 3000, // Sets the interval between slides in milliseconds
        });
        var bar = splide.root.querySelector('.my-slider-progress-bar');
        
        // Updates the bar width whenever the carousel moves:
        splide.on('mounted move', function () {
            var end = splide.Components.Controller.getEnd() + 1;
            var rate = Math.min((splide.index + 1) / end, 1);
            bar.style.width = String(100 * rate) + '%';
        });
        
        splide.mount();
    </script>

    <script>
        function generateSushiId(currentCount) {
            return "S" + currentCount.toString().padStart(2, '0');
        }

        function saveProfile() {
            var nama = document.getElementById('nama').value;
            var paketmenu = document.getElementById('paketmenu').value;
            var sausShoyu = document.getElementById('sausShoyu').checked ? 'Saus Shoyu' : '';
            var wasabi = document.getElementById('wasabi').checked ? 'Wasabi' : '';
            var harga = parseFloat(document.getElementById('harga').value);

            console.log("Nama:", nama);
            console.log("Paket Menu:", paketmenu);
            console.log("Saus Shoyu:", sausShoyu);
            console.log("Wasabi:", wasabi);
            console.log("Harga:", harga);

            // Array Daftar tambahan dan Harga (sesuai yang sudah diberikan sebelumnya)
            const Paket_menu = ["Standar", "VIP"];
            const hargaPaket_menu = { "Standar": 350000, "VIP": 1250000 };
            const hargaTambahan = { "Saus Shoyu": 65000, "Wasabi": 35000 };

            // Fungsi Menghitung Total (sesuai yang sudah diberikan sebelumnya)
            function hargaSubtotal(harga_paket, harga_tambahan) {
                const nilaiHargaA = hargaPaket_menu[harga_paket] || 0;
                let nilaiHargaB = 0;
                harga_tambahan.forEach((tambahan) => {
                    if (hargaTambahan[tambahan]) {
                        nilaiHargaB += hargaTambahan[tambahan];
                    }
                });

                return nilaiHargaA + nilaiHargaB;
            }

            function totalHarga(Subtotal, Harga_sushi) {
                return Subtotal + Harga_sushi;
            }

            const subtotal = hargaSubtotal(paketmenu, [sausShoyu, wasabi]);
            const totalHargaSushi = totalHarga(subtotal, harga);

            // Menghilangkan nilai kosong dari array tambahan
            let tambahanCleaned = [sausShoyu, wasabi].filter(item => item !== '');

            if (nama && paketmenu && harga) {
                // Generate sushi ID
                var sushiCount = localStorage.getItem("sushi_count") || 0;
                sushiCount++;
                localStorage.setItem("sushi_count", sushiCount);
                var sushiId = generateSushiId(sushiCount);

                var existingData = JSON.parse(localStorage.getItem("sushi_data")) || [];

                var newData = {
                    id_sushi: sushiId,
                    nama: nama,
                    paketmenu: paketmenu,
                    tambahan: tambahanCleaned,
                    harga: harga,
                    subtotal: subtotal,
                    totalHarga: totalHargaSushi
                }

                existingData.push(newData);
                localStorage.setItem("sushi_data", JSON.stringify(existingData));

                // Display success alert
                document.getElementById("successAlert").style.display = "block";
                console.log("Success alert displayed");

                // Reset form fields
                document.getElementById('nama').value = '';
                document.getElementById('paketmenu').value = 'Standar';
                document.getElementById('sausShoyu').checked = false;
                document.getElementById('wasabi').checked = false;
                document.getElementById('harga').value = '';
                console.log("Form fields reset");

                // Hide success alert after 3 seconds
                setTimeout(function () {
                    document.getElementById("successAlert").style.display = "none";
                    console.log("Success alert hidden");
                }, 3000);
            }
        }
    </script>

    <!-- Script Fetch API -->
    <script>
        fetch('template/navbar.html')
            .then(response => response.text())
            .then(data => {
                document.querySelector('#navbar').innerHTML = data;
            });

        fetch('template/footer.html')
            .then(response => response.text())
            .then(data => {
                document.querySelector('#footer').innerHTML = data;
        });
    </script>

    <script>
        // Script untuk generate tahun otomatis dalam copyright
        document.getElementById("year").innerHTML = new Date().getFullYear();
    </script>

    <script src="library/js/jquery-3.5.1.slim.min.js"></script>
    <script src="library/js/popper.min.js"></script>
    <script src="library/js/bootstrap.min.js"></script>
</body>
</html>
